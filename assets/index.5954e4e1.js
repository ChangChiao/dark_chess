var G=Object.defineProperty,J=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var P=(e,r,t)=>r in e?G(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,N=(e,r)=>{for(var t in r||(r={}))U.call(r,t)&&P(e,t,r[t]);if(j)for(var t of j(r))V.call(r,t)&&P(e,t,r[t]);return e},S=(e,r)=>J(e,Q(r));import{v as I,j as T,R as F,c as B,r as m,a as Z}from"./vendor.8f23cff8.js";const ee=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}};ee();const x=8,te=4,$={R1:"\u5175",R2:"\u70AE",R3:"\u508C",R4:"\u4FE5",R5:"\u76F8",R6:"\u4ED5",R7:"\u5E25",B1:"\u5352",B2:"\u7832",B3:"\u99AC",B4:"\u8ECA",B5:"\u8C61",B6:"\u58EB",B7:"\u5C07"},re=[[0,-1],[1,0],[0,1],[-1,0]],A=e=>e.substr(0,1),D=e=>Number(e.substr(1,1)),k=e=>[Math.floor(e/8),e%8],E=(e,r)=>e*x+r,q=(e,r)=>{const[t,n]=k(e);return console.log("x, y",t,n),re.map(o=>{const[a,u]=o;return t+a<0||t+a>=te||n+u<0||n+u>=x?null:E(t+a,n+u)}).includes(r)},se=(e,r,t)=>{const[n,s]=k(e),[o,a]=k(r);if(n!==o&&s!==a)return!1;if(!q(e,r)){if(n===o){let u=s-a>0?a:s,h=u===s?a:s;for(let i=u;i<h;i++){let g=E(n,i);if(t[g])return!0}}if(s===a){let u=n-o>0?o:n,h=u===n?o:n;for(let i=u;i<h;i++){let g=E(i,s);if(t[g])return!0}}return!1}},H=(e,r)=>{const t=D(e),n=D(r);return t===2||t===1&&n===7?!0:t>n},ne=(e,r)=>Math.floor(Math.random()*(r-e+1))+e,oe=()=>{let e=Object.keys($);return e=e.map((r,t)=>({id:I(),type:r,isOpen:!1})),e},L=(e,r)=>{let t=[];for(let n=0;n<e;n++)t.push(S(N({},r),{id:I()}));return t},le=()=>{let e=[];return oe().forEach(t=>{const n=t.type.substr(1,1);n==="7"?e=e.concat(L(1,t)):n==="1"?e=e.concat(L(5,t)):e=e.concat(L(2,t))}),e},ce=e=>{for(let r=0;r<e.length;r++){const t=ne(0,e.length-1);[e[r],e[t]]=[e[t],e[r]]}return e},ae=()=>{const e=le();return ce(e)},d=T.exports.jsx,C=T.exports.jsxs;function ue({data:{id:e,type:r,isOpen:t},index:n,clickChess:s,isActive:o}){const a=()=>{s({id:e,type:r,isOpen:t,index:n})},u=r.substr(0,1)==="R";return d("li",{className:B("box",o&&"bg-yellow-200"),onClick:a,children:e?t?d("span",{className:B("chess",u&&"text-red-700 border-red-700"),children:$[r]}):d("span",{className:B("chess","back")}):null})}var ie=F.memo(ue);function fe(){const[e,r]=m.exports.useState({B:0,R:0}),[t,n]=m.exports.useState(null),[s,o]=m.exports.useState(1),[{player1:a,player2:u},h]=m.exports.useState({player1:null,player2:null}),[i,g]=m.exports.useState([]),v=()=>{g(ae()),r({B:0,R:0}),o(1)};m.exports.useEffect(()=>{v(),console.log("start")},[]),m.exports.useEffect(()=>{console.warn("chess",i)},[i]),m.exports.useEffect(()=>{console.log(e),e.B>=16&&(alert("\u7D05\u65B9\u52DD\u5229"),v()),e.R>=16&&(alert("\u9ED1\u65B9\u52DD\u5229"),v())},[e]);const K=({id:l,type:c,isOpen:f,index:p})=>{if(a===null&&Y(c),!f){!t&&X(p);return}let M=W(c);if(!t){if(!M)return;console.log("setting!!!"),n({id:l,type:c,isOpen:f,index:p});return}if(t.id===l){n(null);return}if(t.id!==l){if(M)return;const y=t.index,b=p,z=D(t.type)===2;if(console.warn("selfIndex",y),console.warn("targetIndex",b),!(z?se(y,b,i):q(y,b)))return;l?(console.log(H(t.type,c),"checkCanEat"),H(t.type,c)&&(O(y,b),_(c))):(console.log("no-id"),O(y,b)),o(s*-1),n(null)}},W=l=>{console.log("turn",s);let c=s===1?a:u;const f=A(l);return c===f},O=(l,c)=>{let f=[...i];f[c]=f[l],f[l]={id:"",type:"",isOpen:!0,index:l},g(f)},X=l=>{const c=[...i];c[l]=S(N({},c[l]),{isOpen:!0}),g(c),o(s*-1)},Y=l=>{const c=A(l);h(c==="B"?{player1:"B",player2:"R"}:{player1:"R",player2:"B"})},_=l=>{const c=A(l),f=N({},e);c==="B"&&f.B++,c==="R"&&f.R++,r(f)},w=l=>l?l==="B"?"\u9ED1\u65B9":"\u7D05\u65B9":"",R=l=>l?l==="B"?"bg-black":"bg-red-600":"";return C("div",{className:"App h-screen flex justify-center items-center",children:[C("ul",{className:"top-8 text-xl text-left mr-6 border-dotted border-2 border-gray-500 p-4",children:[C("li",{className:"flex pb-2",children:[d("span",{className:" text-green-700 pr-1",children:"\u73A9\u5BB61: "}),w(a)||"?\u65B9"," ",d("span",{className:B("dot",R(a))})]}),C("li",{className:"flex pb-2",children:[d("span",{className:" text-green-700 pr-1",children:"\u73A9\u5BB62: "}),w(u)||"?\u65B9",d("span",{className:B("dot",R(u))})]}),a!==0&&C("li",{className:"flex",children:[d("span",{className:" text-green-700 pr-1",children:"\u7576\u524D\u8F2A\u5230: "})," ",s===1?"\u73A9\u5BB61":"\u73A9\u5BB62",d("span",{className:B("dot",R(s===1?a:u))})]})]}),d("div",{className:"flex border line",children:Array.from({length:i.length/x}).map((l,c)=>d("ul",{className:"border-r line",children:Array.from({length:x}).map((f,p)=>d(ie,{clickChess:K,isActive:(t==null?void 0:t.id)===i[c*x+p].id,index:c*x+p,data:i[c*x+p]},"row"+p))},"col"+c))})]})}Z.render(d(F.StrictMode,{children:d(fe,{})}),document.getElementById("root"));
