var G=Object.defineProperty,J=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var P=(e,r,t)=>r in e?G(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,C=(e,r)=>{for(var t in r||(r={}))U.call(r,t)&&P(e,t,r[t]);if(j)for(var t of j(r))V.call(r,t)&&P(e,t,r[t]);return e},S=(e,r)=>J(e,Q(r));import{v as I,j as T,R as F,c as R,r as m,a as Z}from"./vendor.8f23cff8.js";const ee=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}};ee();const y=8,te=4,$={R1:"\u5175",R2:"\u70AE",R3:"\u508C",R4:"\u4FE5",R5:"\u76F8",R6:"\u4ED5",R7:"\u5E25",B1:"\u5352",B2:"\u7832",B3:"\u99AC",B4:"\u8ECA",B5:"\u8C61",B6:"\u58EB",B7:"\u5C07"},re=[[0,-1],[1,0],[0,1],[-1,0]],A=e=>e.substr(0,1),N=e=>Number(e.substr(1,1)),D=e=>[Math.floor(e/8),e%8],k=(e,r)=>e*y+r,q=(e,r)=>{const[t,s]=D(e);return console.log("x, y",t,s),re.map(o=>{const[a,f]=o;return t+a<0||t+a>=te||s+f<0||s+f>=y?null:k(t+a,s+f)}).includes(r)},ne=(e,r,t)=>{const[s,n]=D(e),[o,a]=D(r);if(s!==o&&n!==a)return!1;if(!q(e,r)){if(s===o){let f=n-a>0?a:n,h=f===n?a:n;for(let u=f;u<h;u++){let g=k(s,u);if(t[g])return!0}}if(n===a){let f=s-o>0?o:s,h=f===s?o:s;for(let u=f;u<h;u++){let g=k(u,n);if(t[g])return!0}}return!1}},H=(e,r)=>{const t=N(e),s=N(r);return t===2||t===1&&s===7?!0:t>s},se=(e,r)=>Math.floor(Math.random()*(r-e+1))+e,oe=()=>{let e=Object.keys($);return e=e.map((r,t)=>({id:I(),type:r,isOpen:!1})),e},E=(e,r)=>{let t=[];for(let s=0;s<e;s++)t.push(S(C({},r),{id:I()}));return t},ce=()=>{let e=[];return oe().forEach(t=>{const s=t.type.substr(1,1);s==="7"?e=e.concat(E(1,t)):s==="1"?e=e.concat(E(5,t)):e=e.concat(E(2,t))}),e},le=e=>{for(let r=0;r<e.length;r++){const t=se(0,e.length-1);[e[r],e[t]]=[e[t],e[r]]}return e},ae=()=>{const e=ce();return le(e)},d=T.exports.jsx,b=T.exports.jsxs;function ue({data:{id:e,type:r,isOpen:t},index:s,clickChess:n,isActive:o}){const a=()=>{n({id:e,type:r,isOpen:t,index:s})},f=r.substr(0,1)==="R";return d("li",{className:R("box",o&&"bg-yellow-200"),onClick:a,children:e?t?d("span",{className:R("chess",f&&"text-red-700 border-red-700"),children:$[r]}):d("span",{className:R("chess","back")}):null})}var ie=F.memo(ue);function fe(){const[e,r]=m.exports.useState({B:0,R:0}),[t,s]=m.exports.useState(null),[n,o]=m.exports.useState(1),[{player1:a,player2:f},h]=m.exports.useState({player1:null,player2:null}),[u,g]=m.exports.useState([]),v=()=>{g(ae()),r({B:0,R:0}),o(1)};m.exports.useEffect(()=>{v(),console.log("start")},[]),m.exports.useEffect(()=>{console.warn("chess",u)},[u]),m.exports.useEffect(()=>{console.log(e),e.B>=16&&(alert("\u7D05\u65B9\u52DD\u5229"),v()),e.R>=16&&(alert("\u9ED1\u65B9\u52DD\u5229"),v())},[e]);const K=({id:c,type:l,isOpen:i,index:p})=>{if(a===null&&Y(l),!i){!t&&X(p);return}let M=W(l);if(!t){if(!M)return;console.log("setting!!!"),s({id:c,type:l,isOpen:i,index:p});return}if(t.id===c){s(null);return}if(t.id!==c){if(M)return;const B=t.index,x=p,z=N(t.type)===2;if(console.warn("selfIndex",B),console.warn("targetIndex",x),!(z?ne(B,x,u):q(B,x)))return;c?(console.log(H(t.type,l),"checkCanEat"),H(t.type,l)&&(w(B,x),_(l))):(console.log("no-id"),w(B,x)),o(n*-1),s(null)}},W=c=>{console.log("turn",n);let l=n===1?a:f;const i=A(c);return l===i},w=(c,l)=>{let i=[...u];i[l]=i[c],i[c]={id:"",type:"",isOpen:!0,index:c},g(i),console.warn("temp[targetIndex]",i[l]),console.warn("temp[selfIndex]",i[c])},X=c=>{const l=[...u];l[c]=S(C({},l[c]),{isOpen:!0}),g(l),o(n*-1)},Y=c=>{const l=A(c);h(l==="B"?{player1:"B",player2:"R"}:{player1:"R",player2:"B"})},_=c=>{const l=A(c),i=C({},e);l==="B"&&i.B++,l==="R"&&i.R++,r(i)},L=c=>c?c==="B"?"\u9ED1\u65B9":"\u7D05\u65B9":"",O=c=>c?c==="B"?"bg-black":"bg-red-600":"";return b("div",{className:"App h-screen flex justify-center items-center",children:[b("ul",{className:" absolute top-8 text-xl",children:[b("li",{children:["\u73A9\u5BB61:",L(a)]}),b("li",{children:["\u73A9\u5BB62:",L(f)]}),a!==0&&b("li",{className:"flex",children:["\u7576\u524D\u8F2A\u5230 ",n===1?"\u73A9\u5BB61":"\u73A9\u5BB62",d("span",{className:R("dot",O(n===1?a:f))})]})]}),d("div",{className:"flex border line",children:Array.from({length:u.length/y}).map((c,l)=>d("ul",{className:"border-r line",children:Array.from({length:y}).map((i,p)=>d(ie,{clickChess:K,isActive:(t==null?void 0:t.id)===u[l*y+p].id,index:l*y+p,data:u[l*y+p]},"row"+p))},"col"+l))})]})}Z.render(d(F.StrictMode,{children:d(fe,{})}),document.getElementById("root"));
